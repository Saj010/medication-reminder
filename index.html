<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medication Reminder</title>
  <link rel="stylesheet" href="style.css" />
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0d6efd" />
</head>
<body>
  <div class="app">
    <!-- Your app content -->
  </div>

  <!-- ‚úÖ Use COMPAT versions for legacy syntax -->
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.0.0/firebase-messaging-compat.js"></script>

  <script>
    // ‚úÖ Only define config once!
    const firebaseConfig = {
      apiKey: "AIzaSyAzS3_2UlZSDTn3h2rCHqVRSp5rgBnDv3Q",
      authDomain: "medication-reminder-e45b4.firebaseapp.com",
      projectId: "medication-reminder-e45b4",
      storageBucket: "medication-reminder-e45b4.appspot.com",
      messagingSenderId: "111945945049",
      appId: "1:111945945049:web:0fcc5ae55556b05dea13c8",
      measurementId: "G-QYJZS3FH8K"
    };

    firebase.initializeApp(firebaseConfig);
    const messaging = firebase.messaging();

    // ‚úÖ Register service worker and request permission
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => {
          console.log('‚úÖ Service Worker registered');

          Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
              messaging.getToken({
                vapidKey: 'BBIpzRE2hP7UKciVPWyXwX9NRxF06oRlPSxZbEChGZhnZ6qjje8UGqLGqQcv6dSCkvsGbbl_VD4E_Anzu_qRCGo'
              }).then(token => {
                console.log('üì≤ FCM Token:', token);
              }).catch(err => {
                console.error('‚ùå Error getting token:', err);
              });
            } else {
              console.warn('üîï Notification permission denied');
            }
          });
        })
        .catch(err => console.error('‚ùå Service Worker error:', err));
    }
  </script>

  <!-- ‚úÖ Load app logic after Firebase setup -->
  <script src="app.js"></script>
</body>
</html>
